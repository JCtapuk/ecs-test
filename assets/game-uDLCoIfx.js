import{S as Y,a as J,O as N,W as Q,b as Z,B as H,P as _,c as $,d as U,M as ee,e as te}from"./stats.module-DRW68m4M.js";let c={};const B=document.getElementById("leftBtn"),R=document.getElementById("upBtn"),C=document.getElementById("rightBtn");B&&(B.addEventListener("touchstart",t=>{t.preventDefault(),c.ArrowLeft=!0}),B.addEventListener("touchend",t=>{t.preventDefault(),c.ArrowLeft=!1}),B.addEventListener("mousedown",()=>c.ArrowLeft=!0),B.addEventListener("mouseup",()=>c.ArrowLeft=!1));R&&(R.addEventListener("touchstart",t=>{t.preventDefault(),c.ArrowUp=!0}),R.addEventListener("touchend",t=>{t.preventDefault(),c.ArrowUp=!1}),R.addEventListener("mousedown",()=>c.ArrowUp=!0),R.addEventListener("mouseup",()=>c.ArrowUp=!1));C&&(C.addEventListener("touchstart",t=>{t.preventDefault(),c.ArrowRight=!0}),C.addEventListener("touchend",t=>{t.preventDefault(),c.ArrowRight=!1}),C.addEventListener("mousedown",()=>c.ArrowRight=!0),C.addEventListener("mouseup",()=>c.ArrowRight=!1));const m=document.createElement("div");m.style.position="absolute";m.style.top="50%";m.style.left="50%";m.style.transform="translate(-50%, -50%)";m.style.color="red";m.style.fontSize="24px";m.style.display="none";document.body.appendChild(m);const G=new Y,S=new J,b=new N(-5,5,5,-5,.1,10);b.position.z=1;const P=new Q({antialias:!0});document.body.appendChild(P.domElement);document.body.appendChild(S.dom);let y=10,f=10;function T(){P.setSize(window.innerWidth,window.innerHeight),b.left=-window.innerWidth/80,b.right=window.innerWidth/80,b.top=window.innerHeight/80,b.bottom=-window.innerHeight/80,b.updateProjectionMatrix(),y=b.right,f=b.top}window.addEventListener("resize",T);T();const M=new Z({components:{position:{x:{type:"f32",byte:4,default:0},y:{type:"f32",byte:4,default:0}},velocity:{dx:{type:"f32",byte:4,default:0},dy:{type:"f32",byte:4,default:0}},color:{r:{type:"f32",byte:4,default:1},g:{type:"f32",byte:4,default:0},b:{type:"f32",byte:4,default:0}},rotation:{angle:{type:"f32",byte:4,default:0}}}}),s=M.useComponent("position"),g=M.useComponent("velocity"),v=M.useComponent("color"),I=M.useComponent("rotation");let L=100,x=[],W,F,E=new H,ne=new _({size:20,vertexColors:!0}),oe=new $(E,ne);G.add(oe);let o=M.createEntity();s.add(o);g.add(o);I.add(o);s.set(o,"x",0);s.set(o,"y",0);g.set(o,"dx",0);g.set(o,"dy",0);I.set(o,"angle",0);const V=new H,re=new Float32Array([0,.5,0,-.3,-.5,0,.3,-.5,0]);V.setAttribute("position",new U(re,3));const se=new ee({color:16777215}),k=new te(V,se);G.add(k);const z={};window.addEventListener("keydown",t=>{z[t.key]=!0});window.addEventListener("keyup",t=>{z[t.key]=!1});function ie(t){L=t;for(let n of x)M.destroyEntity(n);x.length=0;for(let n=0;n<L;n++){const e=M.createEntity();s.add(e),g.add(e),v.add(e);const r=Math.floor(Math.random()*4);let d,l;r===0?(d=-y,l=(Math.random()-.5)*f*2):r===1?(d=y,l=(Math.random()-.5)*f*2):r===2?(l=-f,d=(Math.random()-.5)*y*2):(l=f,d=(Math.random()-.5)*y*2),s.set(e,"x",d),s.set(e,"y",l);const u=Math.random()*Math.PI*2,w=.1+Math.random()*1;g.set(e,"dx",Math.cos(u)*w),g.set(e,"dy",Math.sin(u)*w);const h=n/L*360,a=ae(h/360,.7,.5);v.set(e,"r",a.r),v.set(e,"g",a.g),v.set(e,"b",a.b),x.push(e)}W=new Float32Array(L*3),F=new Float32Array(L*3),E.setAttribute("position",new U(W,3)),E.setAttribute("color",new U(F,3)),j()}function ae(t,n,e){let r,d,l;{const u=(a,p,i)=>(i<0&&(i+=1),i>1&&(i-=1),i<.16666666666666666?a+(p-a)*6*i:i<.5?p:i<.6666666666666666?a+(p-a)*(.6666666666666666-i)*6:a),w=e+n-e*n,h=2*e-w;r=u(h,w,t+1/3),d=u(h,w,t),l=u(h,w,t-1/3)}return{r,g:d,b:l}}function j(){const t=E.attributes.position.array,n=E.attributes.color.array;for(let e=0;e<x.length;e++){const r=x[e],d=s.get(r,"x"),l=s.get(r,"y"),u=v.get(r,"r"),w=v.get(r,"g"),h=v.get(r,"b");t[e*3]=d,t[e*3+1]=l,t[e*3+2]=0,n[e*3]=u,n[e*3+1]=w,n[e*3+2]=h}E.attributes.position.needsUpdate=!0,E.attributes.color.needsUpdate=!0}let D=!0;function de(t){if(!D)return;const n=t/1e3;let e=s.get(o,"x"),r=s.get(o,"y"),d=g.get(o,"dx"),l=g.get(o,"dy"),u=I.get(o,"angle");(z.ArrowLeft||c.ArrowLeft)&&(u+=3*n),(z.ArrowRight||c.ArrowRight)&&(u-=3*n),(z.ArrowUp||c.ArrowUp)&&(d+=-Math.sin(u)*5*n,l+=Math.cos(u)*5*n),d*=.99,l*=.99,e+=d*n,r+=l*n,e<-y&&(e=y),e>y&&(e=-y),r<-f&&(r=f),r>f&&(r=-f),s.set(o,"x",e),s.set(o,"y",r),g.set(o,"dx",d),g.set(o,"dy",l),I.set(o,"angle",u);for(let a=0;a<x.length;a++){const p=x[a];let i=s.get(p,"x"),A=s.get(p,"y");const K=g.get(p,"dx"),X=g.get(p,"dy");i+=K*n,A+=X*n,i<-y&&(i=y),i>y&&(i=-y),A<-f&&(A=f),A>f&&(A=-f),s.set(p,"x",i),s.set(p,"y",A)}const w=.5,h=.5;for(let a of x){const p=s.get(a,"x"),i=s.get(a,"y");if(Math.sqrt((e-p)**2+(r-i)**2)<w+h){D=!1,m.textContent="Game Over! Collision detected.",m.style.display="block";return}}}function le(){j(),S.begin();let t=s.get(o,"x"),n=s.get(o,"y"),e=I.get(o,"angle");k.position.set(t,n,0),k.rotation.z=e,P.render(G,b),S.end()}let O=0;function q(t){const n=t-O;O=t,de(n),le(),D&&requestAnimationFrame(q)}ie(L);q(0);
